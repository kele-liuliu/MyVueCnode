(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bc22c6c"],{"0cb2":function(e,t,n){var r=n("7b0b"),i=Math.floor,a="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,s,u,l){var p=n+e.length,f=s.length,d=c;return void 0!==u&&(u=r(u),d=o),a.call(l,d,(function(r,a){var o;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(p);case"<":o=u[a.slice(1,-1)];break;default:var c=+a;if(0===c)return r;if(c>f){var l=i(c/10);return 0===l?r:l<=f?void 0===s[l-1]?a.charAt(1):s[l-1]+a.charAt(1):r}o=s[c-1]}return void 0===o?"":o}))}},"14c3":function(e,t,n){var r=n("c6b6"),i=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var a=n.call(e,t);if("object"!==typeof a)throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},3213:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Panel",{scopedSlots:e._u([{key:"header",fn:function(){return[n("h2",[e._v(e._s(e.topic.title))]),n("div",{staticClass:"headerinfo"},[n("div",[e._v(" ·"),n("span",[e._v("发布时间："+e._s(e._f("fromNowTime")(e.topic.create_at)))]),e._v(" ·"),n("span",[e._v(e._s(e.topic.visit_count)+"次浏览")]),e._v(" ·"),n("span",[e._v("来自"+e._s(e._f("getPostChineseTab")(e.topic)))])]),e.isLogin?n("span",{staticClass:"collecbtn",on:{click:e.changecollect}},[e._v(" "+e._s(e.topic.is_collect?"取消收藏":"收藏"))]):e._e()]),!e.userinfo?e._e():n("span",{staticClass:"editbtn"},[e._v("点击编辑")])]},proxy:!0},{key:"contentwarp",fn:function(){return[n("div",{domProps:{innerHTML:e._s(e.topic.content)}})]},proxy:!0}])}),n("Panel",{scopedSlots:e._u([{key:"header",fn:function(){return[n("p",[e._v("回复")])]},proxy:!0},{key:"contentwarp",fn:function(){return[n("div",e._l(e.topic.replies,(function(t,r){return n("div",{key:t.id},[n("div",{staticClass:"commentwarp"},[n("router-link",{staticClass:"lineheight40",attrs:{to:{name:"User",params:{loginname:t.author.loginname}}}},[n("el-avatar",{attrs:{src:t.author.avatar_url}})],1),n("span",[e._v(e._s(t.author.loginname))]),n("a",{attrs:{href:"#"}},[e._v(e._s(r+1)+"楼·"+e._s(e._f("fromNowTime")(t.create_at)))]),n("div",{staticClass:"flex-gorw"},[n("button",{class:{"up-active":t.is_uped},on:{click:function(n){return e.goToUps(t.id)}}},[e._v(" 点赞"+e._s(t.ups.length?t.ups.length:"")+" ")]),e.isLogin?n("button",{on:{click:function(n){return e.respenseother(t)}}},[e._v(" 回复 ")]):e._e()])],1),t.id===e.reply_id?n("div",{staticClass:"text"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reply_text,expression:"reply_text"}],ref:"textarea",refInFor:!0,domProps:{value:e.reply_text},on:{input:function(t){t.target.composing||(e.reply_text=t.target.value)}}}),n("button",{on:{click:function(n){return e.submitrespense(t)}}},[e._v("提交回复")])]):e._e(),n("p",{staticClass:"textindent70",domProps:{innerHTML:e._s(t.content)}})])})),0),n("hr"),n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.text,expression:"text",modifiers:{trim:!0}}],domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),n("button",{on:{click:e.submit}},[e._v("回复")])])]},proxy:!0}])})],1)},i=[],a=n("1da1"),o=(n("96cf"),n("99af"),n("7db0"),n("a434"),n("ac1f"),n("5319"),n("89d7")),c={components:{Panel:o["a"]},name:"Topic",data:function(){return{topic:[],text:"",reply_id:"",reply_text:""}},computed:{isLogin:function(){var e=sessionStorage.getItem("token");return e},userinfo:function(){var e=JSON.parse(sessionStorage.getItem("userinfo"));return e}},created:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.params.topicid,r=e.isLogin,i=r?"/topic/".concat(n,"?accesstoken=").concat(r):"/topic/".concat(n),t.next=5,e.$axios.get(i);case 5:a=t.sent,console.log(a.data),e.topic=a.data,o=a.data.author,e.$store.commit("getuserinfo",o);case 10:case"end":return t.stop()}}),t)})))()},methods:{goToUps:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,i,a,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.isLogin,!r){n.next=12;break}return n.next=4,t.$axios.post("/reply/".concat(e,"/ups"),{accesstoken:t.isLogin});case 4:i=n.sent,a=t.topic.replies.find((function(t){return t.id===e})),a.is_uped="up"===i.action,o=t.userinfo.id,c=a.ups.indexOf(o),"up"===i.action?a.ups.push(o):a.ups.splice(c,1),n.next=14;break;case 12:t.$message({showClose:!0,message:"没有登录跳转到登录页面",type:"error",duration:1500}),t.$router.push("/login");case 14:case"end":return n.stop()}}),n)})))()},submit:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.text,r=e.userinfo,!n){t.next=11;break}return i=e.isLogin,t.next=6,e.$axios.post("/topic/".concat(e.topic.id,"/replies"),{accesstoken:i,content:n});case 6:a=t.sent,console.log(a.data),o={id:a.reply_id,is_uped:!1,ups:[],content:n,author:{avatar_url:r.avatar_url,loginname:r.loginname}},e.topic.replies.push(o),e.text="";case 11:case"end":return t.stop()}}),t)})))()},respenseother:function(e){this.reply_text="@".concat(e.author.loginname," "),this.reply_id=e.id,this.$nextTick((function(){this.$refs.textarea[0].focus()}))},submitrespense:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,i,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(e),r=t.userinfo,i=t.isLogin,n.next=5,t.$axios.post("/topic/".concat(t.topic.id,"/replies"),{accesstoken:i,content:t.reply_text,reply_id:e.id});case 5:a=n.sent,o={id:a.reply_id,is_uped:!1,ups:[],content:"<p>".concat(t.reply_text.replace(/@[w-]+ /,"<a href='/user/'>@".concat(e.author.loginname,"</a>")),"</p>"),author:{avatar_url:r.avatar_url,loginname:r.loginname}},t.topic.replies.push(o),t.reply_text="",t.reply_id="";case 10:case"end":return n.stop()}}),n)})))()},changecollect:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.topic,r=n.is_collect,i=n.id,a=e.isLogin,!r){t.next=8;break}return t.next=5,e.$axios.post("/topic_collect/de_collect",{topic_id:i,accesstoken:a});case 5:e.topic.is_collect=!1,t.next=11;break;case 8:return t.next=10,e.$axios.post("/topic_collect/collect",{topic_id:i,accesstoken:a});case 10:e.topic.is_collect=!0;case 11:case"end":return t.stop()}}),t)})))()}}},s=c,u=(n("c26e"),n("2877")),l=Object(u["a"])(s,r,i,!1,null,null,null);t["default"]=l.exports},"4caf":function(e,t,n){},5319:function(e,t,n){"use strict";var r=n("d784"),i=n("825a"),a=n("50c4"),o=n("a691"),c=n("1d80"),s=n("8aa5"),u=n("0cb2"),l=n("14c3"),p=Math.max,f=Math.min,d=function(e){return void 0===e?e:String(e)};r("replace",2,(function(e,t,n,r){var v=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,x=v?"$":"$0";return[function(n,r){var i=c(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!v&&g||"string"===typeof r&&-1===r.indexOf(x)){var c=n(t,e,this,r);if(c.done)return c.value}var h=i(e),_=String(this),m="function"===typeof r;m||(r=String(r));var b=h.global;if(b){var y=h.unicode;h.lastIndex=0}var E=[];while(1){var w=l(h,_);if(null===w)break;if(E.push(w),!b)break;var k=String(w[0]);""===k&&(h.lastIndex=s(_,a(h.lastIndex),y))}for(var R="",$=0,S=0;S<E.length;S++){w=E[S];for(var T=String(w[0]),I=p(f(o(w.index),_.length),0),P=[],C=1;C<w.length;C++)P.push(d(w[C]));var A=w.groups;if(m){var U=[T].concat(P,I,_);void 0!==A&&U.push(A);var L=String(r.apply(void 0,U))}else L=u(T,_,I,P,A,r);I>=$&&(R+=_.slice($,I)+L,$=I+T.length)}return R+_.slice($)}]}))},"7db0":function(e,t,n){"use strict";var r=n("23e7"),i=n("b727").find,a=n("44d2"),o="find",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),r({target:"Array",proto:!0,forced:c},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},9263:function(e,t,n){"use strict";var r=n("ad6d"),i=n("9f7f"),a=n("5692"),o=RegExp.prototype.exec,c=a("native-string-replace",String.prototype.replace),s=o,u=function(){var e=/a/,t=/b*/g;return o.call(e,"a"),o.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),l=i.UNSUPPORTED_Y||i.BROKEN_CARET,p=void 0!==/()??/.exec("")[1],f=u||p||l;f&&(s=function(e){var t,n,i,a,s=this,f=l&&s.sticky,d=r.call(s),v=s.source,g=0,x=e;return f&&(d=d.replace("y",""),-1===d.indexOf("g")&&(d+="g"),x=String(e).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==e[s.lastIndex-1])&&(v="(?: "+v+")",x=" "+x,g++),n=new RegExp("^(?:"+v+")",d)),p&&(n=new RegExp("^"+v+"$(?!\\s)",d)),u&&(t=s.lastIndex),i=o.call(f?n:s,x),f?i?(i.input=i.input.slice(g),i[0]=i[0].slice(g),i.index=s.lastIndex,s.lastIndex+=i[0].length):s.lastIndex=0:u&&i&&(s.lastIndex=s.global?i.index+i[0].length:t),p&&i&&i.length>1&&c.call(i[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i}),e.exports=s},"9f7f":function(e,t,n){"use strict";var r=n("d039");function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a434:function(e,t,n){"use strict";var r=n("23e7"),i=n("23cb"),a=n("a691"),o=n("50c4"),c=n("7b0b"),s=n("65f0"),u=n("8418"),l=n("1dde"),p=l("splice"),f=Math.max,d=Math.min,v=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!p},{splice:function(e,t){var n,r,l,p,x,h,_=c(this),m=o(_.length),b=i(e,m),y=arguments.length;if(0===y?n=r=0:1===y?(n=0,r=m-b):(n=y-2,r=d(f(a(t),0),m-b)),m+n-r>v)throw TypeError(g);for(l=s(_,r),p=0;p<r;p++)x=b+p,x in _&&u(l,p,_[x]);if(l.length=r,n<r){for(p=b;p<m-r;p++)x=p+r,h=p+n,x in _?_[h]=_[x]:delete _[h];for(p=m;p>m-r+n;p--)delete _[p-1]}else if(n>r)for(p=m-r;p>b;p--)x=p+r-1,h=p+n-1,x in _?_[h]=_[x]:delete _[h];for(p=0;p<n;p++)_[p+b]=arguments[p+2];return _.length=m-r+n,l}})},ac1f:function(e,t,n){"use strict";var r=n("23e7"),i=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(e,t,n){"use strict";var r=n("825a");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},c26e:function(e,t,n){"use strict";n("4caf")},d784:function(e,t,n){"use strict";n("ac1f");var r=n("6eeb"),i=n("d039"),a=n("b622"),o=n("9112"),c=a("species"),s=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),l=a("replace"),p=function(){return!!/./[l]&&""===/./[l]("a","$0")}(),f=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,l){var d=a(e),v=!i((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),g=v&&!i((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!v||!g||"replace"===e&&(!s||!u||p)||"split"===e&&!f){var x=/./[d],h=n(d,""[e],(function(e,t,n,r,i){return t.exec===RegExp.prototype.exec?v&&!i?{done:!0,value:x.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),_=h[0],m=h[1];r(String.prototype,e,_),r(RegExp.prototype,d,2==t?function(e,t){return m.call(e,this,t)}:function(e){return m.call(e,this)})}l&&o(RegExp.prototype[d],"sham",!0)}}}]);
//# sourceMappingURL=chunk-0bc22c6c.225ea0a2.js.map